# HTTP权威指南学习

## 资源

- WEB服务器是 (web resource) 的宿主。web resource是web内容的源头。但资源不一定非得是静态文件。
- WEB服务器会为所有HTTP对象数据附加一个MIME类型。当WEB浏览器从服务器中取回一个对象时，会云查看相关的MIME类型。看看它是否知道应该如何处理这个对象。
- MIME类型是一种文本标记，表示一种主要的对象类型和一个特定的子类型，中间由一条斜杠来分隔。
- HTML格式的文件文档由text/html类型来标记。
- URI包括URL和URN；
- urn:ietf:rfc:2141


## 事务

- 一个HTTP事务由一条请求命令和一条响应结果组成。这种通信是通过名为HTTP报文(HTTP message)的格式化数据块进行的。（包含请求命令和URL的请求报文，包含事务结果的HTTP响应报文。）
- HTTP支持几种不同的请求命令，这些命令被称为HTTP方法（HTTP method）。每条HTTP请求报文都包含一个方法，这个方法会告诉服务器要执行什么操作。

- 

### 五种常见的HTTP方法

HTTP方法 | 描述 |
------| -----|
GET | 从服务器向客户端发送命名资源
PUT | 将来自客户端的数据存储到一个命名的服务器资源中去
DELETE | 从服务器中删除命名资源
POST | 将客户端数据发磅到一个服务器网关应用程序
HEAD | 仅发送命名资源响应中的HTTP首部

### 状态码

HTTP状态码 | 描述
---- | ----
200 | OK.文档正确返回
302 | Redirect(重定向)，到其它地方去获取资源
404 | Not found(未找到)，无法找到这个资源

> 伴随着每个数字状态码，HTTP还会发送一条解释性的“原因短语”文本。

### WEB页面中可以包含多个对象

- 应用程序完成一项任务时通常会发布多个HTTP事务。浏览器会执行一个事务来获取描述页面布局的HTML框架，然后发布另外的HTTP事务来获取每个嵌入式图片、图像面板、java小程序等。这些嵌入式资源甚至可能位于不同的服务器上。一个WEB页面通常并不是单个资源，而是一组资源的集合。

### 报文

- HTTP报文是由一行一行的简单字符串组成的。HTTP报文都是纯文本，不是二进制代码，所以人们可以很方便的对其进行读写。

HTTP报文包括以下三个部分

- 起始行： 报文的第一行就是起始行，在请求报文中用来说明要做些什么，在响应报文中说明出现了什么情况。
- 首部字段： 起始行后面有零个或多个首部字段。每个首部字段都包含一个名字和一个值，为了全球解析，两者之间用冒号来分隔。首部以一个空行结束。添加一个首部字段和添加新行一样简单。
- 主体：空行之后就是可选的报文主体了，其中包含了所有类型的数据。请求主体中包括了要发送给WEB服务器的数据；响应主体中装载了要返回给客户端的数据。起始行和首部都是文本形式且都是结构化的，而主体则不同，主体中可以包含任意的二进制数据（比如图片、视频、音轨、软件程序）。当然，主体中也可以包含文本。


## 连接

报文是如何通过传输控制协议（TCP）连接从一个地方搬移到另一个地方去的。

### TCP/IP

HTTP是个应用层协议。HTTP无需操心网络通信的具体细节，它把联网的细节都交给了通用、可靠的因特网传输协议TCP／IP。

TCP提供了：

1. 无差错的数据传输；
2. 按序传输（数据总是会按照发送时的顺序到达）
3. 未分段的数据流（可以在任意时刻以任意尺寸将数据发送出去）

因特网自身就是基于TCP／IP的，TCP／IP是全世界的计算机和网络设备常用的层次化分组交换网络协议集。TCP／IP隐藏了各种网络和硬件的特点及弱点，使各种类型的计算机和网络都能够进行可靠地通信。

只要建立了TCP连接，客户端和服务器之间的报文交换就不会丢失、不会被破坏，也不会在接收时出现错序了。

### 使用Telnet实例

由于HTTP使用了TCP／IP传输协议，而且它是基于文本的，没有使用那些难以理解的二进制格式，因此很容易直接与WEB服务器进行对话。

Telnet程序可以将键盘连接到某个目标TCP端口，并将此TCP端口的输出回头到显示屏上。Telnet常用于远程终端会话，但它几乎可以连接所有的TCP服务器，包括HTTP服务器。

可以通过Telnet程序直接与WEB服务器进行对话。通过Telnet可以打开一条到某台机器上某个端口的TCP连接，然后直接向那个端口输入一些字符。WEB服务器会将Telnet程序作为一个WEB客户端来处理，所有回送给TCP连接的数据都会显示在屏幕上。

## 版本协议

### HTTP/1.0

1.0是第一个得到广泛使用的HTTP版本。HTTP/1.0添加了版本号、各种HTTP首部、一些额外的方法，以及对多媒体对象的处理。HTTP/1.0使得包含生动图片的WEB页面和交互式表格成为可能，而这些页面和表格促使万维网为人们广泛地接受。这个规范从未得到良好的说明。在这个HTTP协议的商业演进和学术研究都在快速进行的时代，它集体了一系列的最佳实践。

### HTTP/1.0+

在20世纪90年代中叶，很多流行的WEB客户端和服务器都在飞快地向HTTP中添加各种特性，以满足快速扩张且在商业上十分成功的万维网的需要。其中很多特性，包括持久的keep-alive连接、虚拟主机支持，以及代理连接支持都被加入到HTTP之中，并成为非官方的事实标准。这种非正式的HTTP扩展版本通常称为HTTP/1.0+.

### HTTP/1.1

HTTP/1.1重点关注的是校正HTTP设计中的结构性缺陷，明确语义，引入重要的性能优化措施，并删除一些不好的特性。HTTP/1.1还包含了对20世纪90年代末正在发展中的更复杂的WEB应用程序和部署方式的支持。HTTP/1.1是当前使用的HTTP版本。

HTTP-NG(又名HTTP/2.0)

HTTP-NG是HTTP/1.1后继结构的原型建议，它重点关注的是性能的大幅优化，以及更强大的服务逻辑远程执行框架。HTTP－NG的研究工作线程上于1998年。

## WEB的结构组件

WEB浏览器和WEB服务器都是WEB应用程序，这里我们将列出其他一些比较重要的应用程序

应用程序 | 描述
--- | ---
代理 | 位于客户端和服务器之间的HTTP中间实体
缓存 | HTTP的仓库，使常用页面的副本可以保存在离客户端更近的地方
网关 | 连接其他应用程序的特殊WEB服务器
隧道 | 对HTTP通信报文进行盲转发的特殊代理
Agent代理 | 发起自动HTTP请求的半智能WEB客户端


### 代理

代理位于客户端和服务器之间，接收所有客户端的HTTP请求，并将这些请求转发给服务器（可能会对请求进行修改之后转发）。对用户来说，这些应用程序就是一个代理，代表用户访问服务器。出于安全考虑，通常会将代理作为转发所有WEB流量的可信任中间节点使用。代理还可以对请求和响应进行过滤。比如，在企业中对下载的应用程序进行病毒检测，或者对小学生屏蔽一些成人才能看的内容。

### 缓存

WEB缓存或代理缓存是一种特殊的HTTP代理服务器，可以将经过代理传送的常用文档复制保存起来。下一个请求同一文档的客户端就可以享受缓存的私有副本所提供的服务了。

### 网关

网关(gateway)是一种特殊的服务器，作为其他服务器的中间实体使用。通常将HTTP流量转换成其他的协议。网关接受请求时就好像自己是资源的源端服务器一样。客户端可能并不知道自己正在与一个网关进行通信。

例如，一个HTTP/FTP网关会通过HTTP请求接收到FTP URI的请求，但通过FTP协议来获取文档。得到的文档会被封装成一条HTTP报文，发送给客户端。


### 隧道

隧道(tunnel)是建立起来之后，就会在两条连接之间对原始数据进行盲转发的HTTP应用程序。HTTP隧道通常用来在一条或多条HTTP连接上转发非HTTP数据。转发不会窥探数据。

HTTP隧道的一种常见用途就是通过HTTP连接承载加密的安全套接字层(SSL, Secure Sockets Layer) 流量，这样SSL流量就可以穿过只允许WEB流量通过的防火墙了。

### Agent代理

用户Agent代理是代表用户发起HTTP请求的客户端程序。所有发布WEB请求的应用程序都是HTTP AGENT代理。到目前为止，我们只提到过一种HTTP Agent代理：WEB浏览器，但用户Agent代理还有很多其他类型。

比如，有些自己会在WEB上闲逛的自动用户Agent代理，可以在无人监视的情况下，发布HTTP事务并获取内容。这些自动代理的名字通常都很生动，比如“网络蜘蛛”(spiders)或者“web机器人“(web robots)。网络蜘蛛会在WEB上闲逛，搜集信息以构建有效的web内容档案，比如一个搜索引擎的数据库或者为比较购物机器人生成的产品目录。


































































































### Tips
- 